MySQL八股文
- 使用什么存储引擎比较多？有什么特点？
```text
Innodb
1）支持事务
2）行锁
3）B+树索引
4）支持外键
```

- 用不用索引？怎么用？

```
不建议用索引的情况：
1）表记录比较少。例如一两千条甚至只有几百条记录的表，没必要建索引，让查询做全表扫描就好了;
至于多少条记录才算多，个人的经验是以3000作为分界线，记录数不超过 3000可以考虑不建索引. 因为查询索引也是需要时间消耗的.

2）索引的选择性较低。
所谓索引的选择性（Selectivity），是指不重复的索引值（也叫基数，Cardinality）与表记录数（#T）的比值.
选择性取值范围是 ( 0, 1 )，选择性越高的索引价值越大，这是由B+Tree的性质决定的。
例如，如果title字段经常被单独查询，是否需要建索引，我们看一下它的选择性：
SELECT count(DISTINCT(title))/count(*) AS Selectivity FROM employees.titles;
```

- 事务特性，详细讲一下？
```text
原子性（Atomicity）
一致性（Consistency）
隔离性（Isolation）
持久性（Durability）
```

- ACID 中 I 有几种级别？
```
读未读交   脏读
读已提交   不可重复读
可重复读   幻读
串行      低效
```



- 说一说使用的存储引擎使用哪种隔离级别？
```
MYSQL(可重复读)
Oracle(读已提交)
Tidb（快照隔离）
```

- 如何检测慢查询？
```
EXPLAIN
```

- EXPLAIN 怎么用？有什么关键字？

EXPLAIN +SQL语句

- 如何优化慢查询？
```
加索引
优化联合索引
尽量用覆盖索引
遵循最左前缀原则
```

MySQL 八股文 应用篇 2

- InnoDB 中有哪些锁？分别讲一下？

从锁的机制来说，分为乐观锁和悲观锁。

从锁的粒度来说，分为行锁、表锁、间隙锁、元数据锁[表级]（MDL）。在 MySQL 5.5 引入了 MDL，在对一个进行 DML 时，会加 DML 读锁。进行 DDL 时，会加 MDL写锁，并且这个过程一般是自动的。

从锁的实现来说，分为共享锁和排它锁，也就是读锁和写锁，还有意向共享锁和意向排它锁（表级），MYSQL。

间隙锁：
Gap Locks, 间隙锁锁住的是索引记录间的空隙，是为了解决幻读问题被引入的。有一点需要注意，间隙锁和间隙锁本身之间并不冲突，仅仅和插入这个操作发生冲突。
next-key lock:（解决幻读）
next-key lock 是行锁（Record）和间隙锁的并集。o b 在 RR 级别下，InnoDB 使用 next-key 锁进行树搜索和索引扫描。记住这句话，加锁的基本单位是 next-key lock。行锁和间隙锁都是有 next-key 锁满足一定后条件后转换的。

- 行锁和表锁分别有什么特点？
表锁是锁住整张表。
行锁是锁住的是索引。
行锁是两阶段锁协议，并不是使用完就立即释放，而是等事务结束后才释放。

- MySQL 是如何实现乐观锁和悲观锁的？
乐观锁是一种思想，它其实并不是一种真正的『锁』，它会先尝试对资源进行修改，在写回时判断资源是否进行了改变，如果没有发生改变就会写回，否则就会进行重试，在整个的执行过程中其实都没有对数据库进行加锁；
悲观锁就是一种真正的锁了，它会在获取资源前对资源进行加锁，确保同一时刻只有有限的线程能够访问该资源，其他想要尝试获取资源的操作都会进入等待状态，直到该线程完成了对资源的操作并且释放了锁后，其他线程才能重新操作资源。

- 不使用锁如何实现并发？
CAS（Compare and Swap）、Lock-Free。

- 锁锁住的是什么？
行锁锁的就是 B+ 中的索引记录。InnoDB 中，表都以索引的形式存在，每一个索引对应一颗 B+ 树。

MySQL 八股文 应用篇 3

- 两个事务并发读的过程是什么？
并发读。

- 两个事务并发写的过程是什么？
写冲突。

- 两个事务一个读，一个写会发生什么？
读写冲突。

- InnoDB 中的 MVCC 是什么？解决了什么问题？
MVCC(Mutli Version Concurrency Control）：多版本并发控制。
为了提高数据库并发性能，用更好的方式去处理读-写冲突，做到即使有读写冲突时，也能做到不加锁，非阻塞并发读。

- MySQL 是如何保证 crash-safe 的？

- Redo Log 的流程是什么？

- （上一个引申）讲一讲分布式事务？2PC 是什么？

- 有 Redo Log 一定能保证 crash-safe 吗？什么情况下数据会丢失？

MySQL 八股文 应用篇 4

- Binlog 是做什么的？
- Binlog 在什么阶段写入？
- Binlog 在 crash-safe 中充当什么角色？
- 主从同步的流程是什么？
- Binlog、Redo Log、Undo Log、Relay Log 之间有什么区别？

MySQL 八股文 原理篇 1

- InnoDB 底层使用什么数据结构？
- InnoDB 和 MyISAM 底层使用的数据结构有什么不同？
- B 树和 B+ 树有什么区别？
- 为什么不用 AVL、红黑树、跳表？
- InnoDB 怎么建索引的？
- 为什么索引要满足最左匹配？
- 为什么 MySQL 在建表的时候要使用更紧凑的数据结构？
